<%- layout("layouts/allpg.ejs") %>

    <link href='https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css' rel='stylesheet' />

    <h1>
        <%= lat %>
    </h1>
    <h2>
        <%= lon %>
    </h2>
    <div class="dummy"></div>
    <div id='map' style='width: 100%; height: 600px;'></div>
    <script src="../public/map.js"></script>
    <script>

        lat = document.querySelector("h1").innerText
        lon = document.querySelector("h2").innerText
        document.querySelector("h1").style.display = "none";
        document.querySelector("h2").style.display = "none";

        mapboxgl.accessToken = 'pk.eyJ1Ijoia2FydGhpa2V5YW5iYWxhamkiLCJhIjoiY2t2dGd3YmVnM2NrajJudGt1eHdscWVqMyJ9.A0jCxbqQ2SvjO8TVEz2Hxg';
        const map = new mapboxgl.Map({
            container: 'map', // container ID
            style: 'mapbox://styles/mapbox/streets-v12', // style URL
            center: [lon, lat], // starting position [lng, lat]
            zoom: 15, // starting zoom
        });
        // Create a new marker.
        const marker = new mapboxgl.Marker()
            .setLngLat([lon, lat])
            .addTo(map);
        // setTimeout(function(){
        //     window.location.reload(1);},3000);
    </script>